spring.application.name=api-gateway
server.port=${SERVER_PORT}

# Eureka Client Configuration
eureka.client.service-url.defaultZone=${EUREKA_CLIENT_SERVICEURL_DEFAULTZONE}
eureka.instance.prefer-ip-address=true

# Gateway Routes
spring.cloud.gateway.routes[0].id=auth-service
spring.cloud.gateway.routes[0].uri=${AUTH_SERVICE_URL:lb://auth-service}
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/v1/auth/**

spring.cloud.gateway.routes[1].id=content-service
spring.cloud.gateway.routes[1].uri=${CONTENT_SERVICE_URL:lb://content-service}
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/v1/content/**

spring.cloud.gateway.routes[2].id=playback-service
spring.cloud.gateway.routes[2].uri=${PLAYBACK_SERVICE_URL:lb://playback-service}
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/v1/playback/**

spring.cloud.gateway.routes[3].id=ai-service
spring.cloud.gateway.routes[3].uri=${AI_SERVICE_URL:lb://ai-service}
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/v1/ai/**

spring.cloud.gateway.routes[4].id=category-service-route
spring.cloud.gateway.routes[4].uri=${CONTENT_SERVICE_URL:lb://content-service}
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/v1/categories/**

spring.cloud.gateway.routes[5].id=tag-service-route
spring.cloud.gateway.routes[5].uri=${CONTENT_SERVICE_URL:lb://content-service}
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/v1/tags/**

# CORS Configuration
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowedOrigins=*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowedMethods=*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowedHeaders=*

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,gateway
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true

# Redis Configuration
spring.data.redis.host=${REDIS_HOST:redis}
spring.data.redis.port=${REDIS_PORT:6379}

# Rate Limiter Configuration
spring.cloud.gateway.default-filters[0].name=RequestRateLimiter
spring.cloud.gateway.default-filters[0].args.redis-rate-limiter.replenishRate=10
spring.cloud.gateway.default-filters[0].args.redis-rate-limiter.burstCapacity=20
spring.cloud.gateway.default-filters[0].args.key-resolver=#{@userKeyResolver}
spring.cloud.gateway.default-filters[1].name=SecureHeaders

# Logging Configuration
logging.level.root=INFO
logging.level.com.smatech.playlizt=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n
logging.file.name=/var/log/playlizt/api-gateway.log
